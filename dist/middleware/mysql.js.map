{"version":3,"sources":["../../server/middleware/mysql.js"],"names":["config","connectionPool","createPool","connectionLimit","host","process","env","DB_HOST","user","DB_USER","password","DB_PASSWORD","database","DB_DATABASE","timezone","setupMySQL","req","res","next","db","pool","query","values","done","getConnection","connError","conn","console","error","stack","q","queryError","queryResult","queryFields","release","log","sql"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEA,iBAAOA,MAAP;;AAEA,IAAMC,iBAAiB,gBAAMC,UAAN,CAAiB;AACvCC,kBAAiB,EADsB;AAEvCC,OAAMC,QAAQC,GAAR,CAAYC,OAFqB;AAGvCC,OAAMH,QAAQC,GAAR,CAAYG,OAHqB;AAIvCC,WAAUL,QAAQC,GAAR,CAAYK,WAJiB;AAKvCC,WAAUP,QAAQC,GAAR,CAAYO,WALiB;AAMvCC,WAAU;AAN6B,CAAjB,CAAvB;;AASA,IAAMC,aAAa,SAAbA,UAAa,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACtCF,KAAIG,EAAJ,GAAS;AACRC,QAAMnB,cADE;AAERoB,SAAO,eAACA,MAAD,EAAQC,MAAR,EAAgBC,IAAhB,EAAyB;AAC/BtB,kBAAeuB,aAAf,CAA6B,UAACC,SAAD,EAAYC,IAAZ,EAAqB;AACjD,QAAID,SAAJ,EAAe,OAAOE,QAAQC,KAAR,CAAc,+BAAd,EAA+CH,UAAUI,KAAzD,CAAP;AACf,QAAMC,IAAIJ,KAAKL,KAAL,CAAWA,MAAX,EAAkBC,MAAlB,EAA0B,UAACS,UAAD,EAAaC,WAAb,EAA0BC,WAA1B,EAA0C;AAC7EP,UAAKQ,OAAL;AACA,SAAIH,UAAJ,EAAgB,MAAMA,UAAN;AAChBJ,aAAQQ,GAAR,CAAYH,WAAZ;AACAT,UAAKS,WAAL;AACA,KALS,CAAV;AAMAL,YAAQQ,GAAR,CAAYL,EAAEM,GAAd;AACA,IATD;AAUA;AAbO,EAAT;AAeAlB;AACA,CAjBD;;kBAmBeH,U","file":"mysql.js","sourcesContent":["import dotenv from 'dotenv'\r\nimport mysql from 'mysql'\r\n\r\ndotenv.config()\r\n\r\nconst connectionPool = mysql.createPool({\r\n\tconnectionLimit: 10,\r\n\thost: process.env.DB_HOST,\r\n\tuser: process.env.DB_USER,\r\n\tpassword: process.env.DB_PASSWORD,\r\n\tdatabase: process.env.DB_DATABASE,\r\n\ttimezone: 'utc',\r\n})\r\n\r\nconst setupMySQL = (req, res, next) => {\r\n\treq.db = {\r\n\t\tpool: connectionPool,\r\n\t\tquery: (query, values, done) => {\r\n\t\t\tconnectionPool.getConnection((connError, conn) => {\r\n\t\t\t\tif (connError) return console.error('MYSQL ERROR while connecting:', connError.stack)\r\n\t\t\t\tconst q = conn.query(query, values, (queryError, queryResult, queryFields) => {\r\n\t\t\t\t\tconn.release()\r\n\t\t\t\t\tif (queryError) throw queryError\r\n\t\t\t\t\tconsole.log(queryResult)\r\n\t\t\t\t\tdone(queryResult)\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log(q.sql)\r\n\t\t\t})\r\n\t\t},\r\n\t}\r\n\tnext()\r\n}\r\n\r\nexport default setupMySQL\r\n"]}